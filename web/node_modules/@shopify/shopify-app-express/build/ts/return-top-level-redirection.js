"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.returnTopLevelRedirection = void 0;
function returnTopLevelRedirection(_a) {
    var res = _a.res, config = _a.config, bearerPresent = _a.bearerPresent, redirectUrl = _a.redirectUrl;
    // If the request has a bearer token, the app is currently embedded, and must break out of the iframe to
    // re-authenticate
    if (bearerPresent) {
        config.logger.debug("Redirecting to top level at ".concat(redirectUrl, " while embedded, returning headers"));
        res.status(403);
        res.header('X-Shopify-API-Request-Failure-Reauthorize', '1');
        res.header('X-Shopify-API-Request-Failure-Reauthorize-Url', redirectUrl);
        res.end();
    }
    else {
        config.logger.debug("Redirecting to ".concat(redirectUrl, " while at the top level"));
        res.redirect(redirectUrl);
    }
}
exports.returnTopLevelRedirection = returnTopLevelRedirection;
//# sourceMappingURL=return-top-level-redirection.js.map